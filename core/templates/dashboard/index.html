{% extends 'base.html' %}
{% block title %}لوحة المعلومات{% endblock %}
{% block top_title %}نظرة عامة{% endblock %}

{% block content %}
  <div class="row g-3 mb-3">
    <div class="col-6 col-lg-4 col-xxl-2"><div class="cardx stat"><div class="label">عدد الأقسام</div><div class="value">{{ stats.departments }}</div></div></div>
    <div class="col-6 col-lg-4 col-xxl-2"><div class="cardx stat"><div class="label">عدد الأركان</div><div class="value">{{ stats.sections }}</div></div></div>
    <div class="col-6 col-lg-4 col-xxl-2"><div class="cardx stat"><div class="label">عدد المتطوعين</div><div class="value">{{ stats.volunteers }}</div></div></div>
    <div class="col-6 col-lg-4 col-xxl-2"><div class="cardx stat"><div class="label">عدد الحملات</div><div class="value">{{ stats.campaigns }}</div></div></div>
    <div class="col-6 col-lg-4 col-xxl-2"><div class="cardx stat"><div class="label">أركان الحملات</div><div class="value">{{ stats.campaign_sections }}</div></div></div>
    <div class="col-6 col-lg-4 col-xxl-2"><div class="cardx stat"><div class="label">إسنادات المتطوعين</div><div class="value">{{ stats.assignments }}</div></div></div>
  </div>

  <div class="row g-3">
    <div class="col-lg-6">
      <div class="cardx">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 class="mb-0"><i class="bi bi-calendar-week ms-2"></i> أحدث الحملات</h5>
          <a href="{% url 'campaign-index' %}" class="btn btn-sm btn-outline-secondary">عرض الكل</a>
        </div>
        <div class="table-responsive">
          <table class="table align-middle mb-0">
            <thead><tr><th>الحملة</th><th>التواريخ</th><th class="text-start">إحصائيات</th></tr></thead>
            <tbody>
              {% for c in recent_campaigns %}
              <tr>
                <td><a href="{% url 'campaign-show' c.id %}">{{ c.name }}</a></td>
                <td>{{ c.campaign_start_date }} → {{ c.campaign_end_date }}</td>
                <td class="text-start">
                  <span class="badge text-bg-light">{{ c.sections_count }} ركن</span>
                  <span class="badge text-bg-light">{{ c.volunteers_count }} متطوع</span>
                </td>
              </tr>
              {% empty %}
              <tr><td colspan="3" class="text-muted">لا توجد حملات بعد.</td></tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="cardx">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 class="mb-0"><i class="bi bi-person-plus ms-2"></i> أحدث المتطوعين</h5>
          <a href="{% url 'volunteer-index' %}" class="btn btn-sm btn-outline-secondary">عرض الكل</a>
        </div>
        <div class="table-responsive">
          <table class="table align-middle mb-0">
            <thead><tr><th>الاسم</th><th>الجوال</th><th>الجنس</th></tr></thead>
            <tbody>
              {% for v in recent_volunteers %}
              <tr>
                <td><a href="{% url 'volunteer-show' v.id %}">{{ v.name }}</a></td>
                <td>{{ v.phone }}</td>
                <td>{{ v.get_gender_display }}</td>
              </tr>
              {% empty %}
              <tr><td colspan="3" class="text-muted">لا يوجد متطوعون بعد.</td></tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
